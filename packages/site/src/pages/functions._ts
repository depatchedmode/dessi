import { encrypt } from "eciesjs";

const encryptMessage = (message: string, publicKey: string) => {
  const encryptedMessage = encrypt(publicKey, Buffer.from(message));
  return encryptedMessage.toString("hex");
}

const encryptBlob = async (blob: Blob, publicKey: string) => {
  const reader = new FileReader();
  reader.readAsArrayBuffer(blob);
  return new Promise((resolve, reject) => {
    reader.onloadend = () => {
      const encryptedMessage = encrypt(publicKey, Buffer.from(reader.result));
      resolve(encryptedMessage);
    };
  });
}

export { encryptMessage, encryptBlob };
